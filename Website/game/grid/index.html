<!DOCTYPE html>
<html lang="uk">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Турнирная сетка</title>

        <script src="https://code.jquery.com/jquery-3.6.0.js" integrity="sha256-H+K7U5CnXl1h5ywQfKtSj8PCmoN9aaq30gDh27Xc0jk=" crossorigin="anonymous"></script>
        <script src="jquery.bracket.min.js"></script>
        <link href="jquery.bracket.min.css" rel="stylesheet">
        <script src="/assets/js/js.cookie.js"></script>
    </head>
    <body id="body-pd">

    <!--  ПОЛЕ ДЛЯ ТУРНИРНОЙ СЕТКИ  -->


    <div class="demo">

    </div>


    <!-- БЛЯ НЕ ТРОГАТЬ  -->


    <script>

        var TEAMS;

        
        if(getUrlVars().id == 0){
            TEAMS = {"teams": [["Команда 1", "Команда 2"],["Команда 3", "Команда 4"]], "results": [[[[1, 2], [3, 4]],[[5, 6]]],[[[7, 8]],[[9, 10]]],[[[11, 12],[13, 14]],[[15, 16]]]]}
        }else{
            document.addEventListener("DOMContentLoaded", getTeams);
            function getTeams() {
                const competitionId = parseInt(getUrlVars().id);
                if (!competitionId) {
                    console.log("can`t get a competition id")
                    return;
                }

                const requestUrl = "/api/grids/" + competitionId;

                ServerRequest.send("GET", requestUrl, null, "text")
                .then(data => parseTeams(data))
                .catch(err => console.log(err));
            }

            function parseTeams(data) {
                TEAMS = JSON.parse("{" + data + "}");
                console.log(TEAMS);
            }
        }

        // СКРИПТЫ
        // ИНСТРУКЦИЯ: http://www.aropupu.fi/bracket/

        $('.demo').bracket({ // ПОСТОРЕНИЕ
            teamWidth: 100,
            scoreWidth: 36,
            matchMargin: 40,
            roundMargin: 65,
            init: TEAMS
        });

        $('.demo').bracket({ // ГИБКАЯ НАСТРОЙКА
            init: null, // data to initialize
            save: null, // called whenever bracket is modified
            userData: null, // custom user data
            onMatchClick: null, // callback
            onMatchHover: null, // callback
            decorator: null, // a function
            skipSecondaryFinal: false,
            skipGrandFinalComeback: false,
            skipConsolationRound: false,
            dir: 'rl', // "rl" or  "lr",
            disableToolbar: false,
            disableTeamEdit: false,
            teamWidth: '', // number
            scoreWidth: '', // number
            roundMargin: '', // number
            matchMargin: '', // number
        });
    </script>

        <!-- ===== MAIN JS ===== -->
        <script src="/assets/js/main.js"></script>
        <script src="/assets/js/serverRequest.js"></script
    </body>
</html>